
// Define database connection via the `DATABASE_URL` env var
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Define custom output path for generated Prisma Client
generator client {
  provider = "prisma-client-js"
  output   = "/app/generated/prisma-client"
}

model AdvancedSecurityAlert {
  id                 String    @id @default(uuid())
  eventType          String    // e.g., ms.advancedSecurity.alert.created
  subscriptionId     String?
  payload            Json      
  receivedAt         DateTime  @default(now())

  // Optional fields for easier querying and filtering
  alertId            String?   @unique // The unique ID from the Azure DevOps alert
  ruleId             String?
  ruleName           String?
  severity           String?
  state              String?   // e.g., 'open', 'dismissed', 'fixed'
  repositoryName     String?
  branch             String?
  alertUrl           String?

  @@index([eventType])
  @@index([receivedAt])
  @@index([severity])
  @@index([repositoryName])
}